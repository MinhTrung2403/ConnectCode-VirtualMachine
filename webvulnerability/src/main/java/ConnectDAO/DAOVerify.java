/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */
package ConnectDAO;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.Statement;

import ConnectionDatabase.ConnectData;

/**
 *
 * @author MinhTrung
 */
public class DAOVerify {

    Connection conn = null;
    PreparedStatement ps = null;
    ResultSet rs = null;

    public Boolean Verify(String Email, String Code) {
        try {
            conn = new ConnectData().GetConnection();
            Statement ps = conn.createStatement();
            rs = ps.executeQuery("SELECT COUNT(*) FROM ACCOUNT WHERE Email= '" + Email + "' And Code = '" + Code + "'");

            if (rs.next()) {
                int count = rs.getInt(1);
                if (count > 0) {
                    try (Statement UpdateStatment = conn.createStatement()) {

                        int rowsUpdate = UpdateStatment.executeUpdate("UPDATE ACCOUNT SET code = null WHERE Email ='" + Email + "'");
                        if (rowsUpdate > 0) {
                            return true;
                        } else {
                            return false;
                        }
                    }
                } else {
                    return false;
                }
            }

        } catch (Exception e) {
            return false;
        }
        return false;

    }
}
